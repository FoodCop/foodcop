<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enable Location</title>
    <script src='https://cdn.tailwindcss.com'></script>
    <script>
    tailwind.config = {
        theme: {
            extend: {
                colors: {
                    border: "var(--border)",
                    input: "var(--input)",
                    ring: "var(--ring)",
                    background: "var(--background)",
                    foreground: "var(--foreground)",
                    primary: {
                        DEFAULT: "var(--primary)",
                        foreground: "var(--primary-foreground)",
                    },
                    secondary: {
                        DEFAULT: "var(--secondary)",
                        foreground: "var(--secondary-foreground)",
                    },
                    destructive: {
                        DEFAULT: "var(--destructive)",
                        foreground: "var(--destructive-foreground)",
                    },
                    muted: {
                        DEFAULT: "var(--muted)",
                        foreground: "var(--muted-foreground)",
                    },
                    accent: {
                        DEFAULT: "var(--accent)",
                        foreground: "var(--accent-foreground)",
                    },
                    card: {
                        DEFAULT: "var(--card)",
                        foreground: "var(--card-foreground)",
                    },
                },
                borderRadius: {
                    lg: "var(--radius)",
                    md: "calc(var(--radius) - 2px)",
                    sm: "calc(var(--radius) - 4px)",
                },
                fontFamily: {
                    sans: ["var(--font-sans)"],
                    serif: ["var(--font-serif)"],
                    mono: ["var(--font-mono)"],
                },
                boxShadow: {
                    'DEFAULT': 'var(--shadow)',
                },
            },
        }
    }
    </script>
    <script>window.FontAwesomeConfig = {autoReplaceSvg: 'nest'};</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --background: #FAFAFA;
            --foreground: #0f172a;
            --card: #ffffff;
            --card-foreground: #0f172a;
            --primary: #FFD500;
            --primary-foreground: #8A8A8A;
            --secondary: #64748b;
            --secondary-foreground: #ffffff;
            --muted: #FAFAFA;
            --muted-foreground: #0f172a;
            --accent: #f59e0b;
            --accent-foreground: #ffffff;
            --destructive: #ef4444;
            --destructive-foreground: #ffffff;
            --border: #EEE;
            --input: #FFFFFF;
            --ring: #94a3b8;
            --font-sans: Be Vietnam Pro;
            --font-serif: Georgia, serif;
            --font-mono: JetBrains Mono, monospace;
            --radius: 10px;
            --shadow: -2px 4px 12px 4px rgba(51,51,51,0.05);
        }
        ::-webkit-scrollbar { display: none; }
        body {
            font-family: var(--font-sans), sans-serif;
        }
        .pulse-animation {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: .5;
            }
        }
    </style>
</head>
<body class="bg-background">

    <div id="location-screen" class="min-h-screen flex flex-col px-6 py-8">
        <div id="location-header" class="mb-8">
            <button id="back-button" class="text-secondary mb-6 flex items-center gap-2 hover:text-foreground transition-colors">
                <i class="fa-solid fa-arrow-left"></i>
                <span class="font-medium">Back</span>
            </button>
        </div>

        <div class="flex-1 flex flex-col items-center justify-center max-w-md mx-auto w-full">
            <div id="location-icon-section" class="mb-8">
                <div class="w-32 h-32 bg-primary bg-opacity-10 rounded-full flex items-center justify-center relative">
                    <div class="absolute inset-0 bg-primary bg-opacity-20 rounded-full pulse-animation"></div>
                    <i class="fa-solid fa-location-dot text-6xl text-primary relative z-10"></i>
                </div>
            </div>

            <div id="location-content" class="text-center mb-8">
                <h1 class="text-foreground text-2xl font-bold mb-3">Enable Location Access</h1>
                <p class="text-secondary text-base leading-relaxed px-4">We need your location to show you nearby restaurants and personalized recommendations</p>
            </div>

            <div id="location-status" class="w-full mb-8 hidden">
                <div class="bg-card border border-border rounded-[var(--radius)] p-5 shadow-sm">
                    <div class="flex items-start gap-4">
                        <div class="flex-shrink-0">
                            <div class="w-12 h-12 bg-accent bg-opacity-10 rounded-full flex items-center justify-center">
                                <i class="fa-solid fa-check text-accent text-xl"></i>
                            </div>
                        </div>
                        <div class="flex-1">
                            <h3 class="text-foreground font-semibold mb-1">Location Detected</h3>
                            <p class="text-muted-foreground text-sm mb-3">Your current location has been found</p>
                            <div class="bg-muted rounded-md p-3">
                                <div class="flex items-center gap-2 mb-2">
                                    <i class="fa-solid fa-map-marker-alt text-accent text-sm"></i>
                                    <span class="text-foreground font-medium text-sm" id="detected-city">San Francisco</span>
                                </div>
                                <div class="flex items-center gap-2">
                                    <i class="fa-solid fa-globe text-secondary text-sm"></i>
                                    <span class="text-secondary text-sm" id="detected-country">United States</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="location-loading" class="w-full mb-8 hidden">
                <div class="bg-card border border-border rounded-[var(--radius)] p-5">
                    <div class="flex items-center gap-4">
                        <div class="flex-shrink-0">
                            <div class="w-10 h-10 border-4 border-primary border-t-transparent rounded-full animate-spin"></div>
                        </div>
                        <div>
                            <p class="text-foreground font-medium">Detecting your location...</p>
                            <p class="text-muted-foreground text-sm">This may take a few seconds</p>
                        </div>
                    </div>
                </div>
            </div>

            <div id="location-error" class="w-full mb-8 hidden">
                <div class="bg-destructive bg-opacity-10 border border-destructive border-opacity-30 rounded-[var(--radius)] p-5">
                    <div class="flex items-start gap-4">
                        <div class="flex-shrink-0">
                            <i class="fa-solid fa-exclamation-circle text-destructive text-2xl"></i>
                        </div>
                        <div>
                            <h3 class="text-destructive font-semibold mb-1">Location Access Denied</h3>
                            <p class="text-destructive text-opacity-80 text-sm">Please enable location permissions in your browser settings to continue</p>
                        </div>
                    </div>
                </div>
            </div>

            <div id="location-benefits" class="w-full space-y-4 mb-8">
                <div class="flex items-start gap-4">
                    <div class="flex-shrink-0 mt-1">
                        <div class="w-10 h-10 bg-primary bg-opacity-10 rounded-lg flex items-center justify-center">
                            <i class="fa-solid fa-store text-primary text-lg"></i>
                        </div>
                    </div>
                    <div>
                        <h4 class="text-foreground font-semibold text-sm mb-1">Nearby Restaurants</h4>
                        <p class="text-muted-foreground text-xs leading-relaxed">Discover great places to eat around you</p>
                    </div>
                </div>

                <div class="flex items-start gap-4">
                    <div class="flex-shrink-0 mt-1">
                        <div class="w-10 h-10 bg-primary bg-opacity-10 rounded-lg flex items-center justify-center">
                            <i class="fa-solid fa-clock text-primary text-lg"></i>
                        </div>
                    </div>
                    <div>
                        <h4 class="text-foreground font-semibold text-sm mb-1">Accurate Delivery Times</h4>
                        <p class="text-muted-foreground text-xs leading-relaxed">Get precise delivery estimates for your area</p>
                    </div>
                </div>

                <div class="flex items-start gap-4">
                    <div class="flex-shrink-0 mt-1">
                        <div class="w-10 h-10 bg-primary bg-opacity-10 rounded-lg flex items-center justify-center">
                            <i class="fa-solid fa-heart text-primary text-lg"></i>
                        </div>
                    </div>
                    <div>
                        <h4 class="text-foreground font-semibold text-sm mb-1">Personalized Recommendations</h4>
                        <p class="text-muted-foreground text-xs leading-relaxed">Tailored suggestions based on your location</p>
                    </div>
                </div>
            </div>
        </div>

        <div id="location-actions" class="space-y-4 max-w-md mx-auto w-full">
            <button id="enable-location-btn" class="w-full bg-primary text-white font-semibold py-4 px-6 rounded-[var(--radius)] hover:opacity-90 transition-opacity flex items-center justify-center gap-2">
                <i class="fa-solid fa-location-crosshairs"></i>
                <span>Enable Location</span>
            </button>

            <button id="manual-location-btn" class="w-full bg-card border-2 border-border text-foreground font-medium py-4 px-6 rounded-[var(--radius)] hover:border-primary transition-colors">
                Enter Location Manually
            </button>

            <button id="skip-location-btn" class="w-full text-secondary font-medium py-3 hover:text-foreground transition-colors">
                Skip for now
            </button>
        </div>
    </div>

    <script>
        window.addEventListener('load', function() {
            const enableLocationBtn = document.getElementById('enable-location-btn');
            const manualLocationBtn = document.getElementById('manual-location-btn');
            const skipLocationBtn = document.getElementById('skip-location-btn');
            const backButton = document.getElementById('back-button');
            const locationStatus = document.getElementById('location-status');
            const locationLoading = document.getElementById('location-loading');
            const locationError = document.getElementById('location-error');
            const detectedCity = document.getElementById('detected-city');
            const detectedCountry = document.getElementById('detected-country');

            backButton.addEventListener('click', function() {
                window.history.back();
            });

            enableLocationBtn.addEventListener('click', function() {
                detectUserLocation();
            });

            manualLocationBtn.addEventListener('click', function() {
                console.log('Manual location entry requested');
            });

            skipLocationBtn.addEventListener('click', function() {
                console.log('Location setup skipped');
            });

            function detectUserLocation() {
                locationStatus.classList.add('hidden');
                locationError.classList.add('hidden');
                locationLoading.classList.remove('hidden');

                if (!navigator.geolocation) {
                    showError('Geolocation is not supported by your browser');
                    return;
                }

                navigator.geolocation.getCurrentPosition(
                    function(position) {
                        const latitude = position.coords.latitude;
                        const longitude = position.coords.longitude;

                        fetch('https://api.bigdatacloud.net/data/reverse-geocode-client?latitude=' + latitude + '&longitude=' + longitude + '&localityLanguage=en')
                            .then(response => response.json())
                            .then(data => {
                                locationLoading.classList.add('hidden');
                                locationStatus.classList.remove('hidden');
                                
                                detectedCity.textContent = data.city || data.locality || 'Your Location';
                                detectedCountry.textContent = data.countryName || 'Unknown Country';

                                console.log('Location detected:', {
                                    latitude: latitude,
                                    longitude: longitude,
                                    city: data.city || data.locality,
                                    country: data.countryName
                                });
                            })
                            .catch(error => {
                                locationLoading.classList.add('hidden');
                                locationStatus.classList.remove('hidden');
                                detectedCity.textContent = 'Location Found';
                                detectedCountry.textContent = 'Coordinates: ' + latitude.toFixed(4) + ', ' + longitude.toFixed(4);
                                
                                console.log('Location coordinates:', latitude, longitude);
                            });
                    },
                    function(error) {
                        locationLoading.classList.add('hidden');
                        
                        let errorMessage = 'Unable to retrieve your location';
                        
                        switch(error.code) {
                            case error.PERMISSION_DENIED:
                                errorMessage = 'Location access was denied. Please enable location permissions in your browser settings.';
                                break;
                            case error.POSITION_UNAVAILABLE:
                                errorMessage = 'Location information is unavailable.';
                                break;
                            case error.TIMEOUT:
                                errorMessage = 'Location request timed out. Please try again.';
                                break;
                        }
                        
                        showError(errorMessage);
                    },
                    {
                        enableHighAccuracy: true,
                        timeout: 10000,
                        maximumAge: 0
                    }
                );
            }

            function showError(message) {
                locationError.classList.remove('hidden');
                const errorText = locationError.querySelector('p');
                if (errorText) {
                    errorText.textContent = message;
                }
            }
        });
    </script>

</body>
</html>